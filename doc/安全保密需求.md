# 平台安全保密需求

## 一、密码安全策略

1. 密码最小长度限制，非密、秘密级系统应不小于8位，机密级系统应不小于10位；

2. 复杂度要求，必须同时包含大小写字母、数字、标点符号；

3. 涉密系统强制要求：登录失败n次后( n ≤ 5)，锁定账户m分钟(m ≥ 15)；系统管理员可以提前解锁账户；

4. 非密系统，登录失败n次后( n ≤ 5)，可以选择不锁定账户，改为要求输入图形验证码的方式；

5. 登录失败计数应在n分钟后重置为0(n ≥ 15)，登录失败次数过多导致账户锁定后，应立即重置失败次数；

6. 密码最长使用期限：秘密级系统30天后必须更换密码，机密级系统7天后必须更换密码；不更换密码就不允许登录；

7. 密码必须更改n次后，才能再次重复使用当前密码，n ≥ 5；

8. 密码最小使用期限：确保当前密码使用n天后才能再次修改密码，1 ≤ n ≤ 密码最大使用期限；

9. 系统管理员可以重置用户密码，重置后，用户登录必须更改密码；

10. 新建用户首次登录必须更改密码；

11. 密码应混淆后单向加密保存，加密算法应使用国密标准算法；

12. 如果遗忘系统管理员等系统账号密码，必须登录到服务器上使用系统账号命令行管理工具，重置密码；

13. 记录用户修改密码时间，在修改密码页面显示上次修改密码时间； 密码修改后，应发送消息通知用户密码已修改；

14. 修改密码应产生日志记录；

15. 修改密码是应先验证旧密码， 要求用户重复输入两次新密码，两次输入的新密码应相同；

16. 密码应加密传输，使用Https部署；

17. 非密允许记住密码

## 二、用户账号

1. 用户名只能包含数字、英文字母(大小写)、"-"、"_"、“@”、“.”；
2. 用户账号可以与IP地址绑定，限制其只能从固定IP的终端机器登录。可以绑定多个IP；
3. **安全保密员**可以锁定用户账户，禁止其登录，锁定后，如果该用户在线，应立即中止其会话；
4. 可以限制单个用户最大并发会话数；
5. 支持智能卡、生理特征、动态令牌等方式登录（考虑预留接口）；
6. 用户登录、注销事件(包括成功和失败)等必须有日志记录；
7. 在第三方应用调用平台内服务的集成应用场景中，为**第三方应用**提供集成登录身份账号，区别于普通用户的账号，采用不同的验证机制；也能够为第三方应用身份授权，限制其可访问的服务范围；

## 三、分级保护

1. 平台安装启用时，应能够设定**平台最高密级**（非密、秘密、机密、绝密），平台上承载的应用系统可以单独设置最高密级，但是**不能高于**平台最高密级；最高密级设定后，不能再随意更改；
2. 涉密应用系统的涉密业务数据、文件必须标明密级，密级不能高于应用最高密级；数据和文件密级包括**非密、内部、秘密、机密、绝密**，分别对应应用系统的相应密级，其中内部密级可以认为等同于非密，但是需要区别标明；
3. 人员定密，人员密级包括**非密、一般、重要、核心**，一般可以访问秘密及非密数据，重要可以访问机密级和低于机密级数据，核心可以访问绝密级和低于绝密级数据；
4. 涉密应用数据和文件应根据业务需要，限制可以访问的人员范围；
5. 上传的文件应使用国密标准算法进行加密存储，只有满足密级要求的用户可以解密访问；

## 四、三员分立

1. 平台应具备系统管理员、安全保密员和安全审计员三员角色，三员管理权限相互制约；不能查看和修改任何业务数据库中的信息；
2. **系统管理员**可以创建用户账号（只负责分配用户名）、删除账户；
3. 账号创建后，处于未激活状态，不能登录系统；**安全保密员**可以补充完善用户信息，进行授权，激活新建账户，激活后用户可以登录；
4. 系统管理员可以创建系统角色、维护角色信息，删除角色；
5. 系统管理员可以维护系统运行所需的其它配置数据，包括应用、菜单、权限定义、数据模型等；
6. **安全保密员**.负责用户账户信息和状态的维护，用户权限的分配，可以为角色和用户授权，但是授权更改后，处于**未激活**状态，用户仍然使用更改前的授权。**系统管理员**可以激活新的授权状态，激活前系统管理员应可以查看并确认新授权状态。激活后，用户可以使用新的授权；
7. 安全保密员负责用户审计日志以及安全审计员日志的查看，但不能增删改日志内容；
8. 安全审计员负责监督查看系统管理员、安全保密管理员的操作日志,但不能增删改日志内容;
9. 三员账号只能登录服务器后通过命令行工具进行维护；
10. 非密系统可以设置不启动三员

## 五、审计日志

1. 审计日志必须防止篡改。如果日志记录在数据库中，要防止数据库管理员篡改；如果日志记录在文件中，要防止有权限登录服务器的用户篡改；
2. 系统能够对日志存储空间发出报警，如果日志存储空间低于指定阈值，就发出报警通知消息。如果日志存储空间已满，系统应拒绝用户操作，给出报警信息；
3. 能够手动、定时自动导出备份指定时段的审计日志，备份后的审计日志可以删除，但是应保留三个月内的审计日志；
4. 审计范围，包括：系统管理员、安全保密管理员、安全审计员和普通用户所实施的各种操作，包括查阅、备份、维护和导出审计日志；
5. 审计记录内容，应包括事件发生的时间、地点（IP）、类型、主体（用户名、姓名）、客体和结果（包括客体发生改变的详细内容）。 

