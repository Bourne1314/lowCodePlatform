(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["index"],{"0c4e":function(t,e,a){"use strict";a("863f")},3363:function(t,e,a){},"377d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"split-pane custom-data-screen",attrs:{slot:"body"},slot:"body"},[a("split-pane",{attrs:{"default-percent":20,"max-percent":40,split:"vertical"}},[a("template",{slot:"paneL"},[a("el-card",{staticClass:"split-pane__card left-card-menu",attrs:{shadow:"never"}},[a("el-row",{staticClass:"my-card-header",attrs:{slot:"header"},slot:"header"},[a("el-col",{attrs:{span:24}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择应用"},on:{change:function(e){return t.getReportTree()}},model:{value:t.currentAppId,callback:function(e){t.currentAppId=e},expression:"currentAppId"}},t._l(t.appData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),a("el-scrollbar",{staticClass:"default-scrollbar",attrs:{"wrap-class":"default-scrollbar__wrap","view-class":"scrollbar__view"}},[a("el-tree",{ref:"dataScreenTree",attrs:{data:t.typelist,"expand-on-click-node":!1,"highlight-current":"","node-key":"id",props:t.treeProps,"default-expand-all":""},on:{"node-click":t.menuNodeClickHandle},scopedSlots:t._u([{key:"default",fn:function(e){e.node;var i=e.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"custom-tree-node__title"},[a("i",{class:"iconfont icon-folder-open"}),t._v(" "+t._s(i.name)+" ")])])}}])})],1)],1)],1),a("template",{slot:"paneR"},[a("list",{ref:"list",attrs:{"type-list":t.typelist,"app-id":t.currentAppId}})],1)],2)],1)},n=[],s=a("1e71"),o=a.n(s),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticClass:"list"},[a("div",[a("el-main",[a("div",{staticClass:"content"},[a("div",{staticClass:"content__item content__item--add",on:{click:t.handleAdd}},[a("div",[a("i",{staticClass:"el-icon-plus"}),a("p",[t._v("新建大屏")])])]),t._l(t.list,(function(e,i){return a("div",{key:i,staticClass:"content__item",on:{mouseover:function(t){e._menu=!0},mouseout:function(t){e._menu=!1}}},[a("div",{staticClass:"content__info"},[e.backgroundInfo?a("img",{attrs:{src:e.backgroundInfo,alt:""}}):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e._menu,expression:"item._menu"}],staticClass:"content__menu"},[a("div",{staticClass:"content__btn",on:{click:function(a){return t.handleEdit(e)}}},[t._v(" 设计 ")])])]),a("div",{staticClass:"content__main"},[a("span",{staticClass:"content__name"},[t._v(t._s(e.title))]),a("div",{staticClass:"content__menulist"},[a("div",{staticClass:"content__view"},[a("el-tooltip",{attrs:{content:"删除"}},[a("i",{staticClass:"el-icon-delete",on:{click:function(a){return t.handleDel(e,i)}}})]),a("el-tooltip",{attrs:{content:"编辑"}},[a("i",{staticClass:"el-icon-edit",on:{click:function(a){return t.handleUpdate(e,i)}}})]),a("el-tooltip",{attrs:{content:"预览"}},[a("i",{staticClass:"el-icon-view",on:{click:function(a){return t.handleViews(e,i)}}})]),a("el-tooltip",{attrs:{content:"复制"}},[a("i",{staticClass:"el-icon-copy-document",on:{click:function(a){return t.handleCopy(e,i)}}})])],1),a("span",{staticClass:"content__status",class:{"content__status--active":e.status}})])])])}))],2),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper",background:"","page-size":t.page.size,"current-page":t.page.page,total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.page,"page",e)},"update:current-page":function(e){return t.$set(t.page,"page",e)}}})],1)]),a("el-dialog",{attrs:{title:t.dialogTitle,width:"35%",visible:t.box},on:{"update:visible":function(e){t.box=e}}},[a("el-form",{attrs:{size:"mini","label-width":"100px"}},[a("el-row",[a("el-col",{staticStyle:{padding:"0 10px"}},[a("el-form-item",{attrs:{label:"分组"}},[a("el-select",{attrs:{placeholder:"请选择分组"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.typeList,(function(t){return a("el-option",{attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"关联权限",prop:"authName"}},[a("el-input",{attrs:{placeholder:"关联权限",readonly:!0},model:{value:t.form.authName,callback:function(e){t.$set(t.form,"authName",e)},expression:"form.authName"}},[a("el-button",{attrs:{slot:"prepend",title:"请选择",icon:"el-icon-search"},on:{click:t.selectAuthHandler},slot:"prepend"}),a("el-button",{attrs:{slot:"append",title:"清空",icon:"el-icon-remove-outline"},on:{click:t.removeQueryAuthNameHandler},slot:"append"})],1)],1)],1)],1)],1),a("avue-form",{attrs:{option:t.option},on:{submit:t.handleSave},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1)],1),a("select-Auth",{ref:"selectAuth",on:{submit:t.getAuthInfo}})],1)},r=[],c=a("37a5"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.title,"close-on-click-modal":!1,visible:t.visible,width:"900px","append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[a("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoadingData,expression:"isLoadingData"}]},[a("el-main",[a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-col",{staticClass:"text-align-right"},[a("el-input",{staticStyle:{width:"30%"},attrs:{placeholder:"权限名称",size:"small",clearable:""},model:{value:t.dataForm.name,callback:function(e){t.$set(t.dataForm,"name",e)},expression:"dataForm.name"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return t.getDataList()}},slot:"append"})],1)],1)],1),a("el-table",{attrs:{border:"",data:t.dataList,height:"500px","row-key":"id","highlight-current-row":t.highlightFlg,"default-expand-all":!0},on:{"row-dblclick":t.rowDblClickHandler,"row-click":t.rowClickHandler}},[t._e(),a("el-table-column",{attrs:{"header-align":"left",align:"left",label:"权限名称","show-overflow-tooltip":"",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"key-name"},[t._v(" "+t._s(e.row.name)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"code",label:"权限标识","header-align":"center",align:"center","show-overflow-tooltip":""}})],1)],1),a("el-footer",[a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",disabled:null===t.selection},on:{click:t.selectHandler}},[t._v("确定")]),a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")])],1)])],1)],1)},d=[],p={name:"selectAuth",props:{title:{type:String,default:"请选择权限"}},data:function(){return{visible:!1,dataList:[],isLoadingData:!1,selection:null,highlightFlg:!1,appId:"",dataForm:{name:""}}},methods:{showDialog:function(t){this.highlightFlg=!1,this.selection=null,this.appId=t,this.visible=!0,this.dataForm.name="",this.getDataList()},getDataList:function(){var t=this;this.isLoadingData=!0,this.$http({url:"/sysAuths",method:"get",params:{appId:this.appId,name:this.dataForm.name}}).then((function(e){var a=e.data;a&&4e4===a.code?t.dataList=a.list:t.dataList=[],t.isLoadingData=!1}))},selectHandler:function(){this.$emit("submit",this.selection),this.visible=!1},rowDblClickHandler:function(t){this.highlightFlg=!0,this.selection=t,this.selectHandler()},rowClickHandler:function(t){this.highlightFlg=!0,this.selection=t}}},h=p,m=a("cba8"),g=Object(m["a"])(h,u,d,!1,null,"63cbedaa",null),f=g.exports,b={name:"list",props:{typeList:{type:Array,default:[]},appId:{type:String,default:""}},components:{selectAuth:f},data:function(){return{typelist:[],index:0,type:"",dialogTitle:"新建大屏",option:{column:[{label:"大屏名称",span:24,labelWidth:100,prop:"title",rules:[{required:!0,message:"请输入大屏名称",trigger:"blur"}]},{label:"大屏尺寸",span:14,labelWidth:100,prop:"width",placeholder:"请输入宽度",rules:[{required:!0,message:"请输入大屏尺寸",trigger:"blur"}]},{label:"",span:10,labelWidth:1,prop:"height",placeholder:"请输入高度",rules:[{required:!0,message:"请输入大屏尺寸",trigger:"blur"}]}]},page:{page:1,size:10,total:0},form:{},box:!1,activeName:"",list:[],appName:""}},created:function(){},methods:{selectAuthHandler:function(){var t=this;this.$nextTick((function(){t.$refs.selectAuth.showDialog(t.appId)}))},removeQueryAuthNameHandler:function(){this.form.authId="",this.form.authName=""},getAuthInfo:function(t){null!==t&&(this.form.authId=t.id,this.form.authName=t.name)},vaildData:function(t){var e=Number(t);return!!e},getCategory:function(){var t=this;Object(c["d"])().then((function(e){var a=e.data.data;t.typelist=a,t.activeName=(a[0]||{}).categoryValue}))},handleCopy:function(t){var e=this;this.$confirm("确认复制当前大屏","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["b"])(t.id).then((function(t){var a=t.data;4e4===a.code?(e.$message.success("复制成功"),e.getList()):e.$message.error(a.msg)})).catch((function(){e.$message.error("请求失败，请查看控制台或者联系管理员。")}))}))},handleDel:function(t,e){var a=this;this.$confirm("是否确认永久删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["c"])(t.id).then((function(t){var i=t.data;4e4===i.code?(a.list.splice(e,1),a.$message.success(i.msg)):a.$message.error(i.msg)}))})).catch((function(){}))},handleUpdate:function(t,e){this.form=t,this.form.category=this.activeName,this.form.authId=t.authId?t.authId:"",this.form.authName=t.authId&&t.authName?t.authName:"",this.type="edit",this.option.column[1].display=!1,this.option.column[2].display=!1,this.box=!0,this.index=e},handleEdit:function(t){console.log(345,location),window.open(location.href+"build/"+t.id+"?appId="+this.appId,"_blank")},handleViews:function(t){var e=this.$router.resolve({path:"/view/"+t.id});window.open(e.href,"_blank")},handleAdd:function(){this.type="add",this.form.category=this.activeName,this.form.title="",this.form.width=1920,this.form.height=1080,this.form.authId="",this.form.authName="",this.box=!0},handleSave:function(t,e){var a=this;if(e(),"add"==this.type){var i=Object.assign({category:this.activeName,appId:this.appId,backgroundInfo:"/img/bg/bg12.jpg",isDeleted:0},this.form);Object(c["a"])(i).then((function(t){var e=t.data;4e4===e.code?(a.box=!1,a.$message.success("新增成功"),a.getList()):a.$message.error(e.msg)})).catch((function(t){console.log(t)}))}else Object(c["h"])(Object.assign({category:this.form.category},{id:this.form.id,status:this.form.status,authId:this.form.authId,title:this.form.title})).then((function(){a.box=!1,a.$message.success("修改成功"),a.getList()}))},handleSelect:function(t){this.activeName=t,this.page.page=1,this.getList()},handleCurrentChange:function(t){this.page.page=t,this.getList()},handleSizeChange:function(t){this.page.size=t,this.getList()},getList:function(t){var e=this,a=this.$loading({lock:!0,text:"",spinner:"",background:"rgba(0, 0, 0, 0.5)"});this.list=[],Object(c["e"])({category:t||this.activeName,current:this.page.page,size:this.page.size}).then((function(t){var i=t.data;4e4===i.code?(a.close(),e.page.total=i.page.total,e.list=i.page.records,e.initData()):e.$message.error(i.msg)}))},initData:function(){var t=this;this.list.forEach((function(e,a){t.$set(t.list[a],"_menu",!1)}))}}},v=b,y=(a("4703"),a("6a34"),Object(m["a"])(v,l,r,!1,null,"01eacc1a",null)),_=y.exports,w=(a("0be7"),{name:"index",components:{list:_,splitPane:o.a},data:function(){return{appData:[],activeName:"1",currentAppId:"",typelist:[],categoryActiveName:"",appName:"",treeProps:{label:"categoryKey"}}},created:function(){this.updateAppList("")},mounted:function(){},methods:{getReportTree:function(){this.getCategory()},handleSelect:function(t){this.activeName=t},getCategory:function(){var t=this;Object(c["d"])(this.currentAppId).then((function(e){var a=e.data;4e4===a.code?(t.typelist=a.list,t.categoryActiveName=(a[0]||{}).categoryValue,t.$refs.list.activeName=t.categoryActiveName,t.$refs.list.page.page=1,t.typelist.length>0&&t.$nextTick((function(){t.$refs.dataScreenTree.setCurrentKey(t.typelist[0].id),t.menuNodeClickHandle(t.typelist[0])}))):t.$message.error(a.msg)}))},menuNodeClickHandle:function(t){this.$refs.list.activeName=t.id,this.$refs.list.page.page=1,this.$refs.list.getList(t.categoryValue)},updateAppList:function(t){var e=this;this.dataList=[],this.appDataLoading=!0,this.$http({url:location.origin+"/sysGroupApps/list/userOrgApp",method:"get",params:{group_id:t}}).then((function(t){t.data&&4e4===t.data.code?(e.appDataLoading=!1,e.appData=t.data.list,t.data.list.length>0?(e.currentAppId=t.data.list[0].id,e.getCategory(e.currentAppId)):e.currentAppId=""):e.$message.error(t.data.msg)}))}}}),k=w,C=(a("0c4e"),a("78e0"),Object(m["a"])(k,i,n,!1,null,"3b4ca9c3",null));e["default"]=C.exports},"37a5":function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"f",(function(){return r})),a.d(e,"a",(function(){return c})),a.d(e,"g",(function(){return u})),a.d(e,"h",(function(){return d})),a.d(e,"c",(function(){return p}));var i=a("bb36"),n=location.origin,s=function(t){return Object(i["a"])({url:n+"/bladeVisuals",method:"get",params:t})},o=function(t){return Object(i["a"])({url:n+"/bladeVisuals/copy",method:"post",data:{id:t}})},l=function(t){return Object(i["a"])({url:n+"/reportTypes",method:"get",params:{app_id:t,type:"3"}})},r=function(t){return Object(i["a"])({url:n+"/bladeVisuals/"+t,method:"get"})},c=function(t){return Object(i["a"])({url:n+"/bladeVisuals",method:"post",data:{category:t.category,status:t.status,title:t.title,appId:t.appId,authId:t.authId,authName:t.authName,detail:JSON.stringify({name:t.title,width:t.width,height:t.height,scale:1,backgroundImage:"/img/bg/bg1.png",url:"",mark:{},gradeShow:!1,gradeLen:30}),component:"[]"}})},u=function(t){return Object(i["a"])({url:n+"/bladeVisuals",method:"put",data:t})},d=function(t){return Object(i["a"])({url:n+"/bladeVisuals/update/bladeVisual",method:"post",data:{id:t.id,category:t.category,title:t.title,authId:t.authId}})},p=function(t){return Object(i["a"])({url:n+"/bladeVisuals",method:"delete",data:{id:t}})}},4703:function(t,e,a){"use strict";a("b65b")},"6a34":function(t,e,a){"use strict";a("fc8e")},"78e0":function(t,e,a){"use strict";a("3363")},"863f":function(t,e,a){},b65b:function(t,e,a){},fc8e:function(t,e,a){}}]);
//# sourceMappingURL=index.6eb998c5.js.map